<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Risk Pure Premium Model (Taster)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; }
        .section { margin-bottom: 20px; }
        label { display: block; margin: 10px 0 5px; }
        select, input { width: 100%; padding: 8px; margin-bottom: 10px; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #results { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cyber Risk Pure Premium Model (Taster)</h1>
        <p>Simulate the financial impact of high-cost cyber remedial services.</p>

        <div class="section">
            <h2>Simulation Controls</h2>
            <label>Industry (NAICS)</label>
            <select id="naics">
                <option value="22">Utilities (22)</option>
                <option value="23">Construction (23)</option>
                <option value="51">Information (51)</option>
                <option value="52">Finance and Insurance (52)</option>
                <option value="54">Professional Services (54)</option>
                <option value="61">Educational Services (61)</option>
                <option value="62">Health Care (62)</option>
            </select>

            <label>Firm Size (Employees)</label>
            <select id="employee-size">
                <option value="<5">&lt;5</option>
                <option value="5-9">5-9</option>
                <option value="10-14">10-14</option>
                <option value="15-19">15-19</option>
                <option value="20-24">20-24</option>
                <option value="25-29">25-29</option>
                <option value="30-34">30-34</option>
                <option value="35-39">35-39</option>
                <option value="40-49">40-49</option>
                <option value="50-74">50-74</option>
                <option value="75-99">75-99</option>
                <option value="100-149">100-149</option>
                <option value="150-199">150-199</option>
                <option value="200-299">200-299</option>
                <option value="300-399">300-399</option>
                <option value="400-499">400-499</option>
                <option value="500-749">500-749</option>
                <option value="750-999">750-999</option>
                <option value="1,000-1,499">1,000-1,499</option>
                <option value="1,500-1,999">1,500-1,999</option>
                <option value="2,000-2,499">2,000-2,499</option>
                <option value="2,500-4,999">2,500-4,999</option>
                <option value="5,000+">5,000+</option>
            </select>

            <label>Per-Business Deductible ($50,000)</label>
            <input type="number" id="deductible" value="50000">

            <h3>Adverse Events & Remedial Services</h3>
            <label><input type="checkbox" name="services" value="SVC001"> Service SVC001</label>
            <label><input type="checkbox" name="services" value="SVC002"> Service SVC002</label>
            <label><input type="checkbox" name="services" value="SVC003"> Service SVC003</label>
            <label><input type="checkbox" name="services" value="SVC004"> Service SVC004</label>
            <label><input type="checkbox" name="services" value="SVC005"> Service SVC005</label>
            <label><input type="checkbox" name="services" value="SVC006"> Service SVC006</label>
            <label><input type="checkbox" name="services" value="SVC007"> Service SVC007</label>
            <label><input type="checkbox" name="services" value="SVC008"> Service SVC008</label>
        </div>

        <div class="section">
            <button id="run-simulation">Run Simulation</button>
        </div>

        <div class="section">
            <h2>Simulation Results</h2>
            <div id="loading" style="display: none;">Running Simulation...</div>
            <pre id="results">Adjust controls and click "Run Simulation" to see results.</pre>
        </div>

        <script>
            document.getElementById('run-simulation').addEventListener('click', async () => {
                const payload = {
                    naics: document.getElementById('naics').value,
                    employee_size: document.getElementById('employee-size').value,
                    deductible: parseInt(document.getElementById('deductible').value),
                    selected_services: Array.from(document.querySelectorAll('input[name="services"]:checked')).map(el => el.value)
                };
                try {
                    document.getElementById('loading').style.display = 'block';
                    document.getElementById('results').innerText = '';
                    const response = await fetch('/api/main', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const result = await response.json();
                    document.getElementById('loading').style.display = 'none';
                    if (response.ok) {
                        document.getElementById('results').innerText = JSON.stringify(result, null, 2);
                    } else {
                        document.getElementById('results').innerText = `Error: ${result.error || 'Unknown error'}`;
                    }
                } catch (error) {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('results').innerText = `Error: ${error.message}`;
                }
            });
        </script>
</body>
</html>